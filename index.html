<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI Sustainability Monitor — Tracking the AI Boom's Health</title>
    <meta
      name="description"
      content="Daily sustainability index and briefings covering capex, power, supply chains, and policy signals shaping the AI ecosystem."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="icon" href="assets/favicon.png" type="image/png" />
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon.png" />
  </head>
  <body>
    <header class="site-header" id="top">
      <div class="container header-inner">
        <a class="logo" href="index.html">AI Sustainability Monitor</a>
        <button class="nav-toggle" aria-expanded="false" aria-controls="site-nav">
          <span class="sr-only">Toggle navigation</span>
          <span class="nav-toggle__bar"></span>
          <span class="nav-toggle__bar"></span>
          <span class="nav-toggle__bar"></span>
        </button>
        <nav id="site-nav" class="site-nav" aria-label="Primary">
          <ul>
            <li><a href="#health">AI health</a></li>
            <li><a href="#latest">Latest briefings</a></li>
            <li><a href="posts/index.html">Briefing archive</a></li>
            <li><a href="methodology.html">Methodology</a></li>
            <li><a href="glossary.html">Glossary</a></li>
            <li><a href="#metrics">Hard metrics</a></li>
            <li><a href="#playbook">Playbook</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="container hero-inner">
          <div class="hero-copy">
            <p class="eyebrow">AI Ecosystem Watch</p>
            <h1>Tracking whether the AI boom is on sustainable footing.</h1>
            <p>
              Weighted signals across capex, power, semiconductor supply, unit economics, demand,
              and policy show where stress is building. Follow the daily sustainability index,
              drill into cluster briefings, and monitor hard metrics that ground the narrative.
            </p>
            <p class="hero-definition">
              <strong>NSI</strong> stands for <em>Net Sustainability Index</em>: a 0–100 score where 50 is
              neutral, readings above 60 flag resilient momentum, and values slipping toward 45 warn
              that stresses are compounding.
            </p>
            <div class="hero-actions">
              <a class="btn btn-primary" href="#health">Explore the dashboard</a>
              <a class="btn btn-secondary" href="#latest">Read the latest briefings</a>
            </div>
          </div>
          <div class="hero-card" role="presentation" data-overall-card>
            <h2>AI Sustainability Index</h2>
            <p class="hero-card__subtitle">
              <span data-overall-state>—</span>
              <span aria-hidden="true">&bull;</span>
              <span data-overall-score>—</span>
            </p>
            <dl class="hero-card__stats">
              <div>
                <dt>Overall bullish</dt>
                <dd data-overall-bullish>—</dd>
              </div>
              <div>
                <dt>Overall bearish</dt>
                <dd data-overall-bearish>—</dd>
              </div>
            </dl>
            <ul class="hero-card__indicators" data-top-pressures aria-live="polite"></ul>
            <p class="hero-card__note" data-methodology-note>
              Methodology note unavailable. Scores update when new packets are ingested.
            </p>
          </div>
        </div>
      </section>

      <section id="health" class="section section--light">
        <div class="container section-header">
          <h2>AI health snapshot</h2>
          <p>Cluster-level sustainability scores sorted by areas of greatest strain.</p>
        </div>
        <div class="container" data-leaderboard>
          <div class="leaderboard-card">
            <p class="leaderboard-status" data-leaderboard-status>
              Loading AI cluster health…
            </p>
            <div class="leaderboard-table-wrapper" data-leaderboard-wrapper hidden>
              <table class="leaderboard-table">
                <caption class="sr-only">AI cluster sustainability index</caption>
                <thead>
                  <tr>
                    <th scope="col">Rank</th>
                    <th scope="col">Cluster</th>
                    <th scope="col">NSI</th>
                    <th scope="col">Bullish</th>
                    <th scope="col">Bearish</th>
                    <th scope="col">Phase</th>
                    <th scope="col">Confidence</th>
                  </tr>
                </thead>
                <tbody data-leaderboard-body></tbody>
              </table>
            </div>
            <div class="leaderboard-meta">
              <p class="leaderboard-note" data-leaderboard-note hidden></p>
              <p class="leaderboard-asof" data-leaderboard-asof></p>
            </div>
          </div>
        </div>
      </section>

      <section id="latest" class="section section--light">
        <div class="container section-header">
          <h2>Latest briefings</h2>
          <p>
            Fresh write-ups on the key developments shifting the sustainability outlook. Each
            briefing contains rationale, indicators, and tripwires for the next move.
          </p>
        </div>
        <div class="container cards-grid" id="latest-cards" data-limit="6"></div>
        <div class="container latest-archive-link">
          <a class="btn btn-secondary" href="posts/index.html">Browse the archive</a>
        </div>
      </section>

      <section id="metrics" class="section">
        <div class="container section-header">
          <h2>Hard metrics dashboard</h2>
          <p>
            Quantitative checks that anchor the narrative: coverage ratios, secured power, utilisation,
            margins, and financing headroom.
          </p>
        </div>
        <div class="container dashboard-grid" data-hard-metrics></div>
      </section>

      <section id="playbook" class="section section--accent">
        <div class="container playbook-grid">
          <div class="playbook-intro">
            <h2>How to use this monitor</h2>
            <p>
              The sustainability index blends qualitative scoring with weighted hard data. Watch for
              clusters slipping below neutral (NSI &lt; 50), track how long a stress state persists, and
              pair hard metrics with event briefings to gauge whether shocks are structural or transient.
            </p>
          </div>
          <div class="playbook-card">
            <h3>Signal ladder</h3>
            <ol>
              <li>
                <strong>Resilience:</strong> Bullish momentum outweighs headwinds. NSI &gt; 60 with
                improving hard metrics.
              </li>
              <li>
                <strong>Watch:</strong> Mixed signals. NSI between 45–60; confirm with utilisation,
                margins, and policy stability.
              </li>
              <li>
                <strong>Critical:</strong> Persistent deficits. NSI &lt; 45 or hard metrics in tier X/Y;
                review contingency plans.
              </li>
            </ol>
            <p>
              Revisit portfolio positioning, vendor risk, and infrastructure timelines as clusters
              migrate across tiers.
            </p>
          </div>
        </div>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container footer-inner">
        <div>
          <a class="logo" href="#top">AI Sustainability Monitor</a>
          <p class="footer-note">
            Tracking infrastructure, demand, and policy signals shaping the AI boom.
          </p>
        </div>
        <div class="footer-links">
          <a href="#health">AI health</a>
          <a href="#metrics">Hard metrics</a>
          <a href="posts/index.html">Briefing archive</a>
          <a href="methodology.html">Methodology</a>
          <a href="glossary.html">Glossary</a>
          <a href="mailto:signals@aisustainability.monitor">Contact</a>
          <a href="#playbook">Playbook</a>
        </div>
      </div>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const container = document.querySelector('[data-leaderboard]');
        if (!container) {
          return;
        }

        const tableBody = container.querySelector('[data-leaderboard-body]');
        const status = container.querySelector('[data-leaderboard-status]');
        const asOfEl = container.querySelector('[data-leaderboard-asof]');
        const noteEl = container.querySelector('[data-leaderboard-note]');
        const tableWrapper = container.querySelector('[data-leaderboard-wrapper]');
        const heroState = document.querySelector('[data-overall-state]');
        const heroScore = document.querySelector('[data-overall-score]');
        const heroBullish = document.querySelector('[data-overall-bullish]');
        const heroBearish = document.querySelector('[data-overall-bearish]');
        const heroNote = document.querySelector('[data-methodology-note]');
        const heroList = document.querySelector('[data-top-pressures]');
        const metricsContainer = document.querySelector('[data-hard-metrics]');

        const normalizeKey = (value) =>
          value ? value.toString().trim().toLowerCase().replace(/[\s/]+/g, '_') : '';

        const showStatus = (message) => {
          if (!status) return;
          status.textContent = message;
          status.classList.remove('leaderboard-status--hidden');
          status.removeAttribute('aria-hidden');
        };

        const hideStatus = () => {
          if (!status) return;
          status.textContent = '';
          status.classList.add('leaderboard-status--hidden');
          status.setAttribute('aria-hidden', 'true');
        };

        const clearMeta = () => {
          if (asOfEl) {
            asOfEl.textContent = '';
          }
          if (noteEl) {
            noteEl.textContent = '';
            noteEl.hidden = true;
          }
        };

        const hideTable = () => {
          if (tableWrapper) {
            tableWrapper.hidden = true;
          }
        };

        const showTable = () => {
          if (tableWrapper) {
            tableWrapper.hidden = false;
          }
        };

        const showEmpty = () => {
          if (tableBody) {
            tableBody.innerHTML = '';
          }
          hideTable();
          clearMeta();
          showStatus('No clusters available yet.');
        };

        const tierLabels = {
          x: 'Tier X — critical gap',
          y: 'Tier Y — watch',
          z: 'Tier Z — stable',
          ok: 'On track',
        };

        const formatPhase = (value) => {
          if (!value) return '—';
          const text = value.toString().trim();
          return text.charAt(0).toUpperCase() + text.slice(1);
        };

        const formatConfidence = (value) => {
          if (!value) return '—';
          const text = value.toString().trim();
          return text.charAt(0).toUpperCase() + text.slice(1);
        };

        const formatNumber = (value, digits = 1) => {
          if (value === null || value === undefined || Number.isNaN(Number(value))) {
            return '—';
          }
          return Number(value).toFixed(digits);
        };

        const slugMap = new Map();
        const rememberSlug = (clusterValue, slug) => {
          const key = normalizeKey(clusterValue);
          if (!key || !slug || slugMap.has(key)) {
            return;
          }
          slugMap.set(key, slug.toString().trim());
        };

        Promise.all([
          fetch('./data/leaderboard.json', { cache: 'no-store' }).then((response) => {
            if (!response.ok) {
              throw new Error('Missing leaderboard');
            }
            return response.json();
          }),
          fetch('./data/latest_briefings.json', { cache: 'no-store' })
            .then((response) => (response.ok ? response.json() : null))
            .catch(() => null),
          fetch('./data/briefings_archive.json', { cache: 'no-store' })
            .then((response) => (response.ok ? response.json() : null))
            .catch(() => null),
        ])
          .then(([snapshot, latest, archive]) => {
            if (!snapshot || !Array.isArray(snapshot.clusters) || !snapshot.clusters.length) {
              showEmpty();
              return;
            }

            hideStatus();

            if (latest && Array.isArray(latest.items)) {
              latest.items.forEach((item) => {
                if (!item) return;
                rememberSlug(item.cluster, item.slug);
              });
            }
            if (archive && Array.isArray(archive.items)) {
              archive.items.forEach((item) => {
                if (!item) return;
                rememberSlug(item.cluster, item.slug);
              });
            }

            snapshot.clusters.forEach((cluster) => {
              rememberSlug(cluster && cluster.id, cluster && cluster.latest_slug);
            });

            const overall = snapshot.overall || {};
            if (heroState) {
              heroState.textContent = overall.state ? overall.state.toString().toUpperCase() : '—';
            }
            if (heroScore) {
              heroScore.textContent = overall.sustainability_index !== undefined
                ? `${formatNumber(overall.sustainability_index)} NSI`
                : '—';
            }
            if (heroBullish) {
              heroBullish.textContent = overall.bullish_score !== undefined
                ? formatNumber(overall.bullish_score, 0)
                : '—';
            }
            if (heroBearish) {
              heroBearish.textContent = overall.bearish_score !== undefined
                ? formatNumber(overall.bearish_score, 0)
                : '—';
            }
            if (heroNote) {
              const note = snapshot.methodology_note ? snapshot.methodology_note.toString().trim() : '';
              heroNote.textContent = note || 'Methodology note unavailable.';
            }
            if (heroList) {
              heroList.innerHTML = '';
              const items = Array.isArray(snapshot.top_pressures) ? snapshot.top_pressures : [];
              items.forEach((item) => {
                const li = document.createElement('li');
                const label = item && item.name ? item.name : 'Cluster';
                const slug = item && item.latest_slug
                  ? item.latest_slug
                  : slugMap.get(normalizeKey(item && (item.id || item.name)));
                const nsValue = formatNumber(item && item.sustainability_index);
                if (slug) {
                  const link = document.createElement('a');
                  link.href = `posts/${slug}.html`;
                  link.textContent = label;
                  li.appendChild(link);
                } else {
                  li.textContent = label;
                }
                const badge = document.createElement('strong');
                badge.className = 'indicator indicator--watch';
                badge.textContent = `${nsValue} NSI`;
                li.appendChild(badge);
                heroList.appendChild(li);
              });
              if (!heroList.children.length) {
                const li = document.createElement('li');
                li.textContent = 'Waiting for next packet update.';
                heroList.appendChild(li);
              }
            }

            if (metricsContainer && snapshot.hard_metrics) {
              metricsContainer.innerHTML = '';
              const order = ['ccr', 'psr', 'uei', 'mg', 'fh'];
              const keys = order.filter((key) => Object.prototype.hasOwnProperty.call(snapshot.hard_metrics, key));
              keys.forEach((key) => {
                const entry = snapshot.hard_metrics[key];
                const card = document.createElement('article');
                card.className = 'dashboard-card';

                const title = document.createElement('h3');
                title.textContent = entry.label || key.toUpperCase();
                card.appendChild(title);

                const value = document.createElement('p');
                value.className = 'metric-value';
                value.textContent = entry.display_value || '—';
                card.appendChild(value);

                const tier = document.createElement('p');
                tier.className = 'metric-tier';
                const tierKey = entry.tier ? entry.tier.toString().toLowerCase() : '';
                if (tierKey) {
                  tier.classList.add(`metric-tier--${tierKey}`);
                }
                tier.textContent = tierLabels[tierKey] || (entry.tier ? `Tier ${entry.tier}` : '—');
                card.appendChild(tier);

                if (entry.note) {
                  const note = document.createElement('p');
                  note.className = 'metric-note';
                  note.textContent = entry.note;
                  card.appendChild(note);
                }

                if (Array.isArray(entry.sources) && entry.sources.length) {
                  const list = document.createElement('ul');
                  list.className = 'list';
                  entry.sources.forEach((sourceUrl) => {
                    if (!sourceUrl) return;
                    const item = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = sourceUrl;
                    try {
                      const url = new URL(sourceUrl);
                      link.textContent = url.host.replace(/^www\./, '');
                    } catch (error) {
                      link.textContent = sourceUrl;
                    }
                    item.appendChild(link);
                    list.appendChild(item);
                  });
                  card.appendChild(list);
                }

                metricsContainer.appendChild(card);
              });
            }

            const clusters = snapshot.clusters.slice().sort((a, b) => {
              const aIndex = a && a.sustainability_index !== undefined ? Number(a.sustainability_index) : 50;
              const bIndex = b && b.sustainability_index !== undefined ? Number(b.sustainability_index) : 50;
              return aIndex - bIndex;
            });

            if (!clusters.length) {
              showEmpty();
              return;
            }

            if (tableBody) {
              tableBody.innerHTML = '';
              clusters.forEach((cluster, index) => {
                const row = document.createElement('tr');
                row.className = 'leaderboard-row';
                if (index < 3) {
                  row.classList.add('leaderboard-row--top', `leaderboard-row--${index + 1}`);
                }

                const rankCell = document.createElement('td');
                rankCell.className = 'leaderboard-cell leaderboard-cell--rank';
                rankCell.setAttribute('data-label', 'Rank');
                const rankBadge = document.createElement('span');
                rankBadge.className = 'leaderboard-rank';
                if (index < 3) {
                  rankBadge.classList.add(`leaderboard-rank--${index + 1}`);
                }
                rankBadge.textContent = String(index + 1).padStart(2, '0');
                rankCell.appendChild(rankBadge);
                row.appendChild(rankCell);

                const clusterCell = document.createElement('td');
                clusterCell.className = 'leaderboard-cell leaderboard-cell--trigger';
                clusterCell.setAttribute('data-label', 'Cluster');
                const triggerWrapper = document.createElement('div');
                triggerWrapper.className = 'leaderboard-trigger';
                const clusterLabel = cluster && cluster.name ? cluster.name : 'Cluster';
                const slug = slugMap.get(normalizeKey(cluster && (cluster.id || cluster.name)));
                if (slug) {
                  const link = document.createElement('a');
                  link.className = 'leaderboard-title';
                  link.href = `posts/${slug}.html`;
                  link.textContent = clusterLabel;
                  triggerWrapper.appendChild(link);
                } else {
                  const span = document.createElement('span');
                  span.className = 'leaderboard-title';
                  span.textContent = clusterLabel;
                  triggerWrapper.appendChild(span);
                }
                clusterCell.appendChild(triggerWrapper);
                row.appendChild(clusterCell);

                const nsiCell = document.createElement('td');
                nsiCell.className = 'leaderboard-cell leaderboard-cell--score';
                nsiCell.setAttribute('data-label', 'NSI');
                const nsiValue = document.createElement('span');
                nsiValue.className = 'leaderboard-score__value';
                nsiValue.textContent = `${formatNumber(cluster && cluster.sustainability_index)} NSI`;
                nsiCell.appendChild(nsiValue);
                row.appendChild(nsiCell);

                const bullCell = document.createElement('td');
                bullCell.className = 'leaderboard-cell leaderboard-cell--bull';
                bullCell.setAttribute('data-label', 'Bullish');
                bullCell.textContent = formatNumber(cluster && cluster.bullish_score, 0);
                row.appendChild(bullCell);

                const bearCell = document.createElement('td');
                bearCell.className = 'leaderboard-cell leaderboard-cell--bear';
                bearCell.setAttribute('data-label', 'Bearish');
                bearCell.textContent = formatNumber(cluster && cluster.bearish_score, 0);
                row.appendChild(bearCell);

                const phaseCell = document.createElement('td');
                phaseCell.className = 'leaderboard-cell leaderboard-cell--phase';
                phaseCell.setAttribute('data-label', 'Phase');
                const phaseBadge = document.createElement('span');
                phaseBadge.className = 'leaderboard-phase';
                const phaseKey = cluster && cluster.phase ? cluster.phase.toString().trim().toLowerCase() : '';
                if (phaseKey) {
                  phaseBadge.classList.add(`leaderboard-phase--${phaseKey}`);
                }
                phaseBadge.textContent = formatPhase(cluster && cluster.phase);
                phaseCell.appendChild(phaseBadge);
                row.appendChild(phaseCell);

                const confidenceCell = document.createElement('td');
                confidenceCell.className = 'leaderboard-cell leaderboard-cell--confidence';
                confidenceCell.setAttribute('data-label', 'Confidence');
                confidenceCell.textContent = formatConfidence(cluster && cluster.confidence);
                row.appendChild(confidenceCell);

                tableBody.appendChild(row);
              });
            }

            showTable();

            if (noteEl) {
              const thresholds = snapshot.thresholds || {};
              const parts = Object.entries(thresholds)
                .filter(([, value]) => value !== undefined && value !== null)
                .map(([key, value]) => `${key}: ${value}`);
              if (parts.length) {
                noteEl.textContent = `Thresholds · ${parts.join(' | ')}`;
                noteEl.hidden = false;
              }
            }

            if (asOfEl) {
              const asOfValue = snapshot.as_of ? `Updated ${snapshot.as_of}` : '';
              asOfEl.textContent = asOfValue;
            }
          })
          .catch(() => {
            showEmpty();
          });
      });
    </script>
    <script src="assets/js/main.js" defer></script>
    <script src="assets/js/latest.js" defer></script>
  </body>
</html>
